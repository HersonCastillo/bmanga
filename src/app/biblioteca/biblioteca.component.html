<div class="container">
  <div class="row">
    <div class="alert alert-danger" *ngIf="isError.generalLoad">
      <h2>¡Ups!</h2>
      Ocurrió un error al tratar de encontrar el libro que buscas.
      <br><br>
      Inténtalo más tarde. Si el problema persiste repórtalo con un administrador.
      <br><br>
      <code>Log: <b>{{mensajeError}}</b></code>
    </div>
    <div *ngIf="!isError.generalLoad && mangaInformacion" class="media mat-card col-md-9">
      <mat-tab-group>
          <mat-tab label="Información General">
            <mat-card>
              <div class="media-left">
                <img 
                  class="media-object image-card-manga" 
                  [attr.src]="getImage(mangaInformacion.imagen)"
                  onerror="this.src='assets/img/image-no-load.png'"
                  alt="BMANGA Resource">
              </div>
              <div class="media-body" style="padding-left: 15px; position: relative;">
                <br>
                <h1>
                  {{mangaInformacion.nombre}}<br>
                  <small style="color: gray; font-weight: normal;">
                    <small><i>{{mangaInformacion.generos}}</i></small>
                  </small>
                </h1>
                <br>
                <span style="margin-right: 5px;">
                  {{mangaInformacion.sinopsis}}
                </span>
              </div>
              <br>
              <mat-divider></mat-divider>
              <h3>
                <span class="material-icons icon-top">bookmark</span>
                <label class="icon-mar">LISTA DE CAPÍTULOS</label>
              </h3>
              <mat-list>
                <mat-list-item *ngFor="let item of getData(chapters); let i = index;">
                  <div *ngIf="item">
                    {{(item?.titulo !== null) ? item?.titulo : 'Capítulo sin título '}} <b style="margin-left: 5px;">{{item?.capitulo}}</b>
                    <button mat-mini-fab color="primary" style="position: absolute;
                    right: 50px;" (click)="lectura(item?.id)">
                      <span class="material-icons">play_arrow</span>
                    </button>
                    <button mat-mini-fab color="warn" style="position: absolute;
                    right: 0px;">
                      <span class="material-icons">cloud_download</span>
                    </button>
                    </div>
                </mat-list-item>
              </mat-list>
              <br><br>
              <div style="position: relative; text-align: center;">
                <button mat-mini-fab (click)="changePage(i)" class="icon-mar" *ngFor="let i of paginator">
                  {{i + 1}}
                </button>
              </div>
            </mat-card>
          </mat-tab>
          <mat-tab label="Suscripciones">
            <h2>Suscripciones</h2>
            <span>
              Centro de notificaciones de mangas, este beneficio posee la posibilidad de darte un aviso cuando
              un cierto manga ha sido subido a la plataforma.
            </span><br><br><br>
            <form>
              <mat-form-field style="width: 100%;">
                <input 
                matInput 
                placeholder="Escribe un correo electrónico..." 
                name="email" 
                autocomplete="off"
                [formControl]="emailControl"
                [errorStateMatcher]="matcher"
                [(ngModel)]="email"/>
                <span class="material-icons" matSuffix>email</span>
                <mat-error *ngIf="emailControl.hasError('email') && !emailControl.hasError('required')">
                  Por favor ingresa un correo electrónico <strong>válido</strong>
                </mat-error>
                <mat-error *ngIf="emailControl.hasError('required')">
                  El correo electrónico es <strong>requerido</strong>
                </mat-error>
              </mat-form-field>
            </form>
            <br>
            <button 
            mat-raised-button 
            color="primary"
            (click)="envEmail()">Recibir notificaciones</button>
          </mat-tab>
          <mat-tab label="Historial">
              <span>Historial</span>
          </mat-tab>
      </mat-tab-group>
    </div>
    <div class="col-md-3" *ngIf="!isError.generalLoad && mangaInformacion">
      <h2>Obras similares</h2>
      <mat-divider></mat-divider>
      <br>
      <mat-card 
      *ngFor="let similar of mangasSimilares" 
      [routerLink]="['/biblioteca', similar.nombre]"
      class="custom-card">
        <img mat-card-image 
        [attr.src]="getSizeImageCard(similar.imagen)"
        onerror="this.src='assets/img/image-no-load.png'"
        alt="Resource">
        <mat-card-header class="header-card">
          <mat-card-title>{{similar.nombre}}</mat-card-title>
        </mat-card-header>
      </mat-card>
      <br>
      <h2>Algo al azar</h2>
      <mat-divider></mat-divider>
      <br>
      <mat-card 
      *ngFor="let otros of otrosMangas"
      [routerLink]="['/biblioteca', otros.nombre]"
      class="custom-card">
        <img mat-card-image 
        [attr.src]="getSizeImageCard(otros.imagen)"
        onerror="this.src='assets/img/image-no-load.png'"
        alt="Resource">
        <mat-card-header class="header-card">
          <mat-card-title>{{otros.nombre}}</mat-card-title>
        </mat-card-header>
      </mat-card>
    </div>
  </div>
</div>